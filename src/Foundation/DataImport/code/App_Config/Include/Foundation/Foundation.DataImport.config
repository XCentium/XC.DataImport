<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/">
  <sitecore>
      <log4net>
          <logger name="XC.Foundation.DataImport.Diagnostics.DataImportLogger" additivity="false">
              <level value="INFO" />
              <appender-ref ref="xcDataImportLogFileAppender" />
          </logger>
          <appender name="xcDataImportLogFileAppender" type="log4net.Appender.SitecoreLogFileAppender, Sitecore.Logging">
              <file value="$(dataFolder)/logs/xc.DataImport.log.{date}.txt" />
              <appendToFile value="true" />
              <layout type="log4net.Layout.PatternLayout">
                  <conversionPattern value="%4t %d{ABSOLUTE} %-5p %m%n" />
              </layout>
              <encoding value="utf-8" />
          </appender>
      </log4net>
      <api>
          <services>
              <configuration type="Sitecore.Services.Infrastructure.Configuration.ServicesConfiguration, Sitecore.Services.Infrastructure">
                  <allowedControllers hint="list:AddController">
                      <allowedController desc="XC_DataImportController">XC.Foundation.DataImport.Controllers.ImportConfigurationController, XC.Foundation.DataImport</allowedController>
                      <allowedController desc="XC_TestController">XC.Foundation.DataImport.Controllers.ImportController, XC.Foundation.DataImport</allowedController>
                  </allowedControllers>
              </configuration>
          </services>
      </api>
      <settings>
          <setting name="XC.Foundation.DataImport.DataFolder" value="$(sourceFolder)/XC.DataImport/DataFolder"/>
      </settings>
      <pipelines>
          <xc.dataimport.postprocessing>
              <processor type="XC.Foundation.DataImport.Pipelines.PostProcessing.RunPostProcessingScripts, XC.Foundation.DataImport"/>
          </xc.dataimport.postprocessing>
          <xc.dataimport.fieldprocessing>
              <processor type="XC.Foundation.DataImport.Pipelines.FieldProcessing.RunFieldProcessingScripts, XC.Foundation.DataImport"/>
          </xc.dataimport.fieldprocessing>
          <xc.dataimport.sourceprocessing>
              <processor type="XC.Foundation.DataImport.Pipelines.PostProcessing.RunSourceProcessingScripts, XC.Foundation.DataImport"/>
          </xc.dataimport.sourceprocessing>
      </pipelines>
      <xc.dataimport>
          <sourceProviders>
              <sourceProvider name="FileDataSource" modelType="XC.Foundation.DataImport.Repositories.DataSources.FileDataSource" dataSourceType="XC.Foundation.DataImport.Models.DataSources.FileDataSourceModel">
                  <field name="FilePath" type="text" />                  
              </sourceProvider>
              <sourceProvider name="SitecoreDataSource" modelType="XC.Foundation.DataImport.Repositories.DataSources.SitecoreDataSource" dataSourceType="XC.Foundation.DataImport.Models.DataSources.SitecoreDataSourceModel">
                  <field name="DatabaseName" type="select" optionsSource="/sitecore/api/ssc/dataimport/mappings/-/getdatabases" triggerFields="Template,Path" />
                  <field name="Template" type="select" optionsSource="/sitecore/api/ssc/dataimport/mappings/[DatabaseName]/gettemplates" />
                  <field name="Path" type="tree" optionsSource="/sitecore/api/ssc/dataimport/mappings/[DatabaseName]/getsitecoretree"/>
              </sourceProvider>
              <sourceProvider name="SitecoreQueryDataSource" modelType="XC.Foundation.DataImport.Repositories.DataSources.SitecoreQueryDataSource" dataSourceType="XC.Foundation.DataImport.Models.DataSources.SitecoreQueryDataSourceModel">
                  <field name="DatabaseName" type="select" optionsSource="/sitecore/api/ssc/dataimport/mappings/-/getdatabases" />
                  <field name="Query" type="textarea" />
              </sourceProvider>
              <sourceProvider name="SqlDataSource" modelType="XC.Foundation.DataImport.Repositories.DataSources.SqlDataSource" dataSourceType="XC.Foundation.DataImport.Models.DataSources.SqlDataSourceModel">
                  <field name="ConnectionStringName" type="textarea"  optionsSource="/sitecore/api/ssc/dataimport/mappings/-/GetConnectionStrings"/>
                  <field name="SqlStatement" type="textarea" />
              </sourceProvider>
          </sourceProviders>
          <targetProviders>
              <targetProvider name="SitecoreDataSource" modelType="XC.Foundation.DataImport.Models.DataSources.TargetSitecoreDataSourceModel" dataSourceType="XC.Foundation.DataImport.Repositories.Repositories.SitecoreRepository">
                  <field name="DatabaseName" type="select" optionsSource="/sitecore/api/ssc/dataimport/mappings/-/getdatabases" triggerFields="Template,Path" />                  
                  <field name="Template" type="select" optionsSource="/sitecore/api/ssc/dataimport/mappings/[DatabaseName]/gettemplates" />
                  <field name="Path" type="tree" optionsSource="/sitecore/api/ssc/dataimport/mappings/[DatabaseName]/getsitecoretree" />
              </targetProvider>
              <targetProvider name="SitecoreFormsDataSource" modelType="XC.Foundation.DataImport.Models.DataSources.TargetSitecoreFormsDataSourceModel" dataSourceType="XC.Foundation.DataImport.Repositories.Repositories.SitecoreRepository">
                  <field name="ConnectionStringName" type="text" />
              </targetProvider>
          </targetProviders>
      </xc.dataimport>
  </sitecore>
</configuration>